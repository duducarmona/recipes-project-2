<main id="update-recipe">

  <h1>Edit recipe</h1>

{{#renderVars x y}}
{{/renderVars}}

  <form action="/recipes/{{recipe.id}}" method="post">
    <label for="title">Title:</label><br>
    <input type="text" name="title" value="{{recipe.title}}" required><br>

    <label for="image">Image:</label><br>
    <input type="text" name="image" value="{{recipe.image}}"><br>

      {{#each recipe.ingredients}}

      <div id="ingredient">
      <label for="ingredient">Ingredient:</label><br>
      <select name="ingredient">
          <option value="">--Please choose an ingredient--</option>
          {{#each ../ingredients}}
          {{#createOption ../this.ingredient._id this._id this.name}}
          {{/createOption}}
          {{!-- <option class="options" value={{this._id}}>{{this.name}}</option> --}}
          {{/each}}
      </select><br>
      <label for="amount">Amount:</label><br>
      <input type="number" name="amount" value="{{this.amount}}"><br>

      <label for="unit">Unit:</label><br>
      <input type="text" name="unit" value="{{this.unit}}"><br>

      <button class="small-button">Remove ingredient</button>
      </div>
      {{/each}}
      <button class="small-button" type="button" id="add-ingredient">Add another ingredient</button>

    <p>Instructions</p>
    <ol id="steps">
      {{#each recipe.instructions}}
      <li>
        <input class="step" type="text" name="steps" value="{{this.step}}">
        <button class="delete-button delete-step" type="button">
          <img src="/images/trash-icon-20.png" alt="trash icon"/>
        </button>
      </li>
      {{/each}}
    </ol>
    <button class="small-button" type="button" id="add-step">Add step</button>

    <br>
    <button class="button" type="submit">Save Recipe</button>
  </form>
</main>

{{> add_remove_steps}}
{{> add_remove_ingredients}}

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const ingredientSelectors = document.querySelectorAll('select');
    ingredientSelectors.forEach((selector, index) => {
      console.log(index);

      const selectedIngredientId = {{{ json recipe.ingredients.[2].ingredient._id }}};
      console.log(selectedIngredientId);

      const selectedIngredient = document.querySelector(`select option[value='${selectedIngredientId}']`);
      selectedIngredient.selected = true;
    })
  })
</script>

